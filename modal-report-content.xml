<!-- Report Modal -->
    <div class="modal-overlay" id="reportModal">
        <div class="modal">
            <button class="modal-close" id="reportModalClose">&times;</button>
            <div class="modal-header">
                <div class="modal-icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 9v4m0 4h.01M5.072 5.072a7 7 0 1 1 9.856 9.856 7 7 0 0 1-9.856-9.856z"/>
                    </svg>
                </div>
                <h3 class="modal-title">Laporkan Pesan</h3>
                <p class="modal-subtitle">Bantu kami meningkatkan kualitas layanan</p>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="reportReason">Alasan Pelaporan</label>
                    <select class="form-select" id="reportReason">
                        <option value="">Pilih alasan...</option>
                        <option value="inappropriate">Konten tidak pantas</option>
                        <option value="inaccurate">Informasi tidak akurat</option>
                        <option value="harmful">Konten berbahaya</option>
                        <option value="spam">Spam atau iklan</option>
                        <option value="other">Lainnya</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="reportMessage">Detail (Opsional)</label>
                    <textarea class="form-textarea" id="reportMessage" rows="4" placeholder="Jelaskan lebih lanjut tentang pesan yang ingin Anda laporkan..."></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" id="cancelReportBtn">Batal</button>
                <button class="btn-primary" id="submitReportBtn">Kirim Laporan</button>
            </div>
        </div>
    </div>

    <script>
    //<![CDATA[
    (function() {
        'use strict';
        
        // Setup report modal functionality
        document.addEventListener('DOMContentLoaded', function() {
            // Report modal elements
            var reportModal = document.getElementById('reportModal');
            var reportModalClose = document.getElementById('reportModalClose');
            var cancelReportBtn = document.getElementById('cancelReportBtn');
            var submitReportBtn = document.getElementById('submitReportBtn');
            var reportReason = document.getElementById('reportReason');
            var reportMessage = document.getElementById('reportMessage');
            
            // Close modal functions
            function closeModal() {
                reportModal.classList.remove('active');
                // Reset form
                reportReason.value = '';
                reportMessage.value = '';
            }
            
            if (reportModalClose) {
                reportModalClose.addEventListener('click', closeModal);
            }
            
            if (cancelReportBtn) {
                cancelReportBtn.addEventListener('click', closeModal);
            }
            
            // Submit report function
            if (submitReportBtn) {
                submitReportBtn.addEventListener('click', function() {
                    var selectedReason = reportReason.value;
                    var additionalMessage = reportMessage.value.trim();
                    
                    if (!selectedReason) {
                        if (window.SantrilogyApp && typeof window.SantrilogyApp.showToast === 'function') {
                            window.SantrilogyApp.showToast('Silakan pilih alasan pelaporan', 'error');
                        } else {
                            alert('Silakan pilih alasan pelaporan');
                        }
                        return;
                    }
                    
                    // Create mailto link with pre-filled information
                    var subject = encodeURIComponent('Laporan Pesan dari Santrilogy AI');
                    var body = encodeURIComponent(
                        'Alasan Pelaporan: ' + selectedReason + '\n' +
                        'Detail Tambahan: ' + (additionalMessage || 'Tidak ada detail tambahan') + '\n\n' +
                        'Mohon tinjau pesan yang dilaporkan sesegera mungkin.'
                    );
                    
                    var mailtoLink = 'mailto:santrilogyapp@gmail.com?subject=' + subject + '&body=' + body;
                    
                    // Open email client
                    window.location.href = mailtoLink;
                    
                    // Show success message and close modal
                    if (window.SantrilogyApp && typeof window.SantrilogyApp.showToast === 'function') {
                        window.SantrilogyApp.showToast('Laporan akan dikirim melalui email', 'success');
                    } else {
                        alert('Laporan akan dikirim melalui email');
                    }
                    
                    closeModal();
                });
            }
            
            // Add global function to open report modal
            if (typeof window.SantrilogyApp === 'undefined') {
                window.SantrilogyApp = {};
            }
            
            window.SantrilogyApp.openReportModal = function() {
                reportModal.style.display = 'flex';
                setTimeout(function() {
                    reportModal.classList.add('active');
                }, 10);
            };
        });
    })();
    //]]>
    </script>
</body>
</html>